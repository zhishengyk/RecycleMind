# RecycleMind 废料管理系统

一个基于PyQt6的废料管理系统，支持废料库存管理、产品标准管理和智能合成方案计算。

## 功能特性

### 1. 废料管理
- 添加、编辑、删除废料信息
- 记录废料的存放区域和化学成分（Si, Fe, Cu, Mn, Mg, Zn, Ti, Cr, Ni, Zr, Sr, Bi, Na, Al）
- 管理废料重量和单价信息

### 2. 产品标准管理
- 创建和管理产品标准
- 定义各种金属和成分的占比限制范围
- 支持多种铝合金标准（6061、7075、2024等）

### 3. 智能合成方案计算
- 根据废料库存和产品标准计算最佳合成方案
- 支持按区域筛选废料进行优化计算
- 使用线性规划优化算法最小化成本
- 确保最终产品符合化学成分要求
- 提供详细的配比分析和成本计算，包含区域信息

### 4. 用户权限管理
- 多角色权限系统：管理员、操作员、查看者
- 细粒度权限控制：用户管理、废料管理、标准管理、优化计算、数据备份、日志查看
- 用户账户管理：添加、编辑、删除用户，重置密码
- 用户状态管理：启用/禁用用户账户

### 5. 操作日志记录
- 完整的操作历史记录
- 记录用户登录、数据操作、系统管理等活动
- 支持按用户、操作类型、时间范围筛选日志
- 详细的操作信息：操作时间、用户、操作类型、详细信息

### 6. 数据备份恢复
- 手动数据备份功能
- 自动备份设置（可配置备份间隔）
- 备份历史记录管理
- 数据恢复功能
- 备份文件压缩存储

## 安装和设置

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 运行程序
```bash
python main.py
```

## 使用说明

### 系统登录
1. 启动程序后，使用用户名和密码登录
2. 默认管理员账户：用户名 `admin`，密码 `admin123`
3. 不同角色用户具有不同的操作权限

### 废料管理
1. 在"废料管理"标签页中添加废料信息
2. 输入废料名称、存放区域、化学成分含量（百分比）、重量和单价
3. 化学成分以百分比形式输入（如：0.5表示0.5%）
4. 可以编辑或删除现有废料记录（需要相应权限）

### 产品标准管理
1. 在"产品标准"标签页中管理产品标准
2. 添加新产品标准，定义各元素的含量范围（百分比）
3. 每个元素可设置最小值和最大值范围
4. 系统已预设常用铝合金标准

### 合成方案计算
1. 在"合成方案"标签页中选择目标产品标准
2. 可选择特定区域进行筛选（可选）
3. 点击"计算最佳合成方案"
4. 查看优化结果，包括：
   - 总成本和重量
   - 废料配比详情（包含区域信息）
   - 元素分析结果

### 用户管理（管理员权限）
1. 点击菜单栏"系统" → "用户管理"
2. 在用户管理对话框中可以：
   - 添加新用户，设置用户名、密码、角色和邮箱
   - 编辑现有用户信息
   - 删除用户（禁用账户）
   - 重置用户密码

### 操作日志查看（管理员权限）
1. 在用户管理对话框的"操作日志"标签页中
2. 可以查看所有用户的操作历史
3. 支持按用户、操作类型筛选日志
4. 显示详细的操作信息

### 数据备份恢复（管理员权限）
1. 点击菜单栏"系统" → "数据备份"
2. 手动创建数据备份：
   - 选择备份目录
   - 系统自动创建压缩备份文件
3. 恢复数据备份：
   - 选择备份文件
   - 确认恢复操作（会覆盖当前数据）
4. 设置自动备份：
   - 配置备份间隔
   - 启用/禁用自动备份功能

## 技术特点

- **优化算法**：使用SciPy的SLSQP优化器进行线性规划
- **约束处理**：确保元素含量在目标范围内
- **成本优化**：自动计算最低成本配比方案
- **用户友好**：直观的图形界面和详细的结果展示
- **权限管理**：基于角色的访问控制（RBAC）系统
- **日志记录**：完整的操作审计和追踪功能
- **数据安全**：自动备份和恢复机制
- **模块化设计**：清晰的代码结构和易于扩展的架构

## 数据库结构

### users表
存储用户信息，包括用户名、密码、角色、邮箱等

### wastes表
存储废料信息，包括化学成分、重量、单价等

### product_standards表
存储产品标准，使用JSON格式存储元素含量范围

### operation_logs表
存储操作日志，记录用户操作历史

### backup_logs表
存储备份记录，记录数据备份历史

## 注意事项

- 确保数据库连接配置正确
- 废料数据需要准确输入化学成分含量
- 产品标准中的元素范围要合理设置
- 优化计算可能需要一定时间，请耐心等待
- 首次使用请使用默认管理员账户登录（admin/admin123）
- 定期进行数据备份，防止数据丢失
- 不同角色用户具有不同的操作权限，请合理分配用户角色
- 操作日志会记录所有重要操作，便于审计和问题追踪
